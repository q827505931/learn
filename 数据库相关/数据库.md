##                                   数据库相关知识点

###### 1.数据库三范式

​	（1）列不可再分原则，数据库的每一列都必须是不可再细分的

​    （2）主键唯一，其他字段必须依赖于主键

​    （3）建立主外键关联，拆分表，消除数据冗余

###### 2.什么是事务，事务的特性，事务的隔离级别

​	事务是数据库操作的最小单元，要么全部执行，要么全部失败，（每条sql 语句都可以视为一个事务）具有以下四大特性：

atomic: 原子性 事务要么全部成功，要么全部失败，不可能停留在成功一半，另一半失败的状态，简单的来讲，事务不可分割，不可约简；

coincidence:一致性 事务执行前后数据库中的数据应该是一致的，比如A给B转账，转账前后AB的钱数总和应该是一致的。

isolation:隔离性 对事务的并发操作应当是彼此隔离的，不然会对数据的安全产生影响

durability:持久性 事务提交后应该是持久化到硬盘的，不会因为断电等操作造成数据丢失

事务的隔离级别有四种

​	（1）read uncommited 读未提交 顾名思义，可以读取到其他事务未提交的数据，会产生脏读。

​	（2）read commited 读已提交 顾名思义 只能读取到其他事务提交的数据 会产生不可重复读, 解决了脏读的问题 会产生不可重复读 oracle 默认的隔离级别

不可重复读: T1 第一次读取某一条数据，这时候T2修改了该条数据，T1再次读取，两次读取的数据不一致，即产生了不可重复读

​	（3）read reaptable 可重复读 事务开启期间其他事物不可修改数据（update）,解决了不可重复读的问题 会产生幻读 MySQL 的默认隔离级别

幻读：T1按某个条件查询数据，假如得到了10条，这时候事务T2insert并提交了某条数据，该数据也符合T1的查询条件，T1再次查询，得到了11条数据，似乎产生了幻觉。可重复读只是禁止了另一个事务的update操作，并没有禁止insert 操作

​	（4）serlizable 序列化 事务的最高隔离级别 所有事务串行执行，一个事务开启时禁止其他事务的所有操作，效率较低，一般不建议使用

###### 3.char和varchar

​	char不可变字符串 会给一个指定长度，eg:char(5) 长度为5的定长字符串 存储时会固定占据该长度的空间

​	varchar可变字符串 根据存储的数据动态的确定长度，总长度为字符串长度加1 1用来标识字符串长度

​	优缺点：空间和时间的取舍 

​	char 效率更高，但是如果长度给的不合理会造成磁盘空间的浪费，一般来说存储密码的md5字符串,固定长度的订单号（注：订单号尽管有时候全部是数字，但是一般还是会采取char类型）会采取char 

​	varchar 效率相对较低，但是节省空间 若事先不能确保字符串长度，为了避免空间浪费 ，建议采用varchar

###### 4.float和double的区别

在java语言中 两者都是代表小数，小数默认数据类型是double(8字节) ，float(4个字节) 在数据库中 也是类似的区别 不过都会丢失精度 建议使用bigdecimal 

###### 5.mysql 的内连接 左连接 未连接

内连接只会显示符合连接条件的数据，不符合条件的数据不予显示；

左连接和右连接都是外连接的一种，有主从表的概念，左连接会将左表视为主表，主表数据全部展示，从表只显示符合连接条件的数据

6.mysql性能优化

（1）尽量减少select * 的使用，select * 会去做全表扫描，影响效率

（2）不要使用select xx,xx from t_xx where xx = null 的语句 数据给默认值 对于null 数据库要做特殊处理 影响效率

（3）减少子查询的使用，连接要比子查询效率高

（4）减少在where条件中函数或者表达式的使用

（5）定值查询可以采用between and ,where xx = ' xx' and xx = 'xx', 少使用 in （xx,xx,xx）

7.事务四大特性之间的关系

持久性主要是应对数据库崩溃的

对于无并发条件下只要它满足了原子性，那么一致性一定可以得到保证

对于并发条件下不仅要考虑原子性，还需要考虑对事务进行合理隔离策略才能保证数据的一致性

8.可重复读与读已提交如何实现

借助多版本并发控制mvcc实现，读未提交总是读取最新的数据行，串行化会将读到的行加锁

两个概念：

​	系统版本号，是一个递增的数字，每次执行事务，系统版本号都会+1

​	事务版本号，事务开始时的系统版本号

每一行数据后面都有两个隐藏列：

​	创建版本号：创建该行数据的系统版本号

​	删除版本号 :  删除该行时的系统版本号 如果删除版本号未定义或者大于当前版本号代表当前版本号可用

（未完待续）